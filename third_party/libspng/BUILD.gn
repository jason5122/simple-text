assert(path_exists("src/spng"),
       "Missing submodules. Run: git submodule update --init --recursive")

static_library("libspng") {
  sources = [ "src/spng/spng.c" ]

  # https://libspng.org/docs/build/#miniz
  defines = [ "SPNG_USE_MINIZ" ]

  configs -= [ "//build/config/compiler:simple_text_code" ]
  configs += [ "//build/config/compiler:no_simple_text_code" ]

  # Silence message.
  cflags = [ "-Wno-#pragma-messages" ]

  public_configs = [ ":libspng_includes" ]

  deps = [ "//third_party/miniz" ]
}

config("libspng_includes") {
  include_dirs = [ "src/spng" ]
}
