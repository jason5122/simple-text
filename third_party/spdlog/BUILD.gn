assert(path_exists("src/src"),
       "Missing submodules. Run: git submodule update --init --recursive")

static_library("spdlog") {
  sources = [
    "src/src/async.cpp",
    "src/src/cfg.cpp",
    "src/src/color_sinks.cpp",
    "src/src/file_sinks.cpp",
    "src/src/spdlog.cpp",
    "src/src/stdout_sinks.cpp",
  ]

  configs -= [ "//build/config/compiler:simple_text_code" ]
  configs += [ "//build/config/compiler:no_simple_text_code" ]

  public_configs = [ ":spdlog_includes" ]
}

config("spdlog_includes") {
  defines = [
    "SPDLOG_COMPILED_LIB",
    "SPDLOG_NO_EXCEPTIONS",
    "SPDLOG_USE_STD_FORMAT",
  ]
  if (is_win) {
    defines += [ "SPDLOG_WCHAR_TO_UTF8_SUPPORT" ]
  }

  include_dirs = [ "src/include" ]
}
